<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Builds, shuttle busses and cabs</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="/2008/02/builds-shuttle-busses-and-cabs" rel="canonical" />
  <!-- Feed -->

  <link href="/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="/theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="There have been a few blog posts recently about when to do builds. I'd like to add a few thoughts of mine. I'll follow mostly two trains...">

    <meta name="author" content="Axel Hecht">





<!-- Open Graph -->
<meta property="og:site_name" content="Axel Hecht"/>
<meta property="og:title" content="Builds, shuttle busses and cabs"/>
<meta property="og:description" content="There have been a few blog posts recently about when to do builds. I'd like to add a few thoughts of mine. I'll follow mostly two trains..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/2008/02/builds-shuttle-busses-and-cabs"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2008-02-07 17:52:00+00:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/axel-hecht.html">
<meta property="article:section" content="Mozilla"/>
<meta property="og:image" content="/theme/images/post-bg.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@axelhecht">
    <meta name="twitter:title" content="Builds, shuttle busses and cabs">
    <meta name="twitter:url" content="/2008/02/builds-shuttle-busses-and-cabs">

        <meta name="twitter:image:src" content="/theme/images/post-bg.jpg">

      <meta name="twitter:description" content="There have been a few blog posts recently about when to do builds. I'd like to add a few thoughts of mine. I'll follow mostly two trains...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Builds, shuttle busses and cabs",
  "headline": "Builds, shuttle busses and cabs",
  "datePublished": "2008-02-07 17:52:00+00:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Axel Hecht",
    "url": "/author/axel-hecht.html"
  },
  "image": "/theme/images/post-bg.jpg",
  "url": "/2008/02/builds-shuttle-busses-and-cabs",
  "description": "There have been a few blog posts recently about when to do builds. I'd like to add a few thoughts of mine. I'll follow mostly two trains..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>

                  <li role="presentation"><a href="/category/l10n.html">L10n</a></li>
                  <li role="presentation"><a href="/category/misc.html">Misc</a></li>
                  <li class="nav-mozilla active" role="presentation"><a href="/category/mozilla.html">Mozilla</a></li>
                  <li role="presentation"><a href="/category/rdf.html">RDF</a></li>
                  <li role="presentation"><a href="/category/tech.html">Tech</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Builds, shuttle busses and cabs</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="/author/axel-hecht.html">Axel Hecht</a>
            | <time datetime="Thu 07 February 2008">Thu 07 February 2008</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>There have been a few blog posts recently about when to do builds. I'd like to add a few thoughts of mine.</p>
<div class="line-block">
<div class="line">I'll follow mostly two trains of thought</div>
<div class="line">* each check-in raises a bunch of questions, to which we want answers -- quick</div>
<div class="line">* the road to these answers has a limited traffic capacity</div>
</div>
<p>The current proposals map to two images in my head, the current &quot;build continuously&quot; model is basically a shuttle bus. &quot;Build on check-in&quot; is more like a cab. Now, the interesting artifact in our picture is that both the shuttle bus and the cab have an unlimited capacity for passengers, or check-ins. Do check-ins blend? Yes, they do.</p>
<p>Now, the blending of patches has an upside and a downside. On the upside, it enables us to get around traffic jams. We can just transport as many check-ins as we get. The downside is, the answers that the builds and test runs give can't be associated with individual check-ins anymore. Well, &quot;passes&quot; can, &quot;failures&quot; cannot. I'll postpone perf testing here, 10% win, 9% loss, end up where you were.</p>
<p>There have been previous posts on whether shuttle buses or cabs are the way to go, and my answer is &quot;neither&quot;. I guess there is an easy answer if you assume that you have no limits on machines, in that case, just let them run on check-in. That's great -- at least as long as you can actually relate the resulting build, and the tests run on that build, to a source tree. Once we're running out of machines, the story is a little different. Every machine should be continuously building then, and the trick is, 'by then'. That is, each build should adjust the time it's waiting for more check-ins such that, by the time the last idle machine kicks off, all available machine are fairly distributed across the ETA of the next machine. Let's pick some arbitrary number for an initial stabilization time, Tmin. Waiting time for machine n of N could then be</p>
<p>Tmin * (N-n)/(N-1) + ETA/2 * (n-1)/(N-1)</p>
<p>if we choose to weight linearly. I did a little <a class="reference external" href="http://people.mozilla.org/~axel/waitings.html">scatterplot game</a> for you to pick different amounts of slaves, mintimes, etas and such. I bet there is a way to pick better values for Tmin and the power based on bonsai and tinderbox statistics.</p>
<p>Sadly, neither tinderbox nor buildbot offer this, but I could imagine that this would be of more general use to buildbot clients, and would be something to get upstream.</p>
<p>The other part of the picture is &quot;did this particular change impact ???&quot;. Now, for questions like &quot;does this compile?&quot;, the answer is fairly trivial. I think the same goes for things like unit tests or ref tests. As long as the current state of the tree passes, we're fine. When it fails, that's a more interesting question. Like, it might make sense to then actually refine the built source stamps.</p>
<p>But for questions regarding perfomance, there are worst case scenarios. Like, you see a 1% regression. Is it a 1% regression from patch 2, or is patch 2 actually improving performance, but patch 1 just totally borked it? On top of that, performance data is noisy data. There's likely a good heuristic algorithm to distribute sampling of builds to measure performance on based on total count of tests run per build, age of the build, and current noise on the performance data for that build. So in particular for performance testing, it would be interesting to not just build the latest well-defined source state (thanks cvs), but also to be able to build previously not built source states, and in the performance architecture, to spend the available cycles to further refine the statistics on a range of recent builds, instead of just the latest. And to, of course, relate those data points with the source stamp that correlates to the build that was tested right now.</p>

            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Builds, shuttle busses and cabs&amp;url=/2008/02/builds-shuttle-busses-and-cabs" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2008/02/builds-shuttle-busses-and-cabs" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=/2008/02/builds-shuttle-busses-and-cabs" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>


                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="/theme/js/script.js"></script>

</body>
</html>